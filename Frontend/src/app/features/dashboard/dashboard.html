<div class="page">
  <header class="header">
    <div>
      <h1>Market Dashboard</h1>
      <p class="muted">BTCUSD live quotes + candles</p>
    </div>

    <div class="status" [attr.data-status]="status()">
      <span class="dot"></span>
      <span>{{ status() }}</span>
    </div>
  </header>

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  <div class="layout">
    <section class="card">
      <h2>BTCUSD</h2>

      @if (!quote()) {
        <div class="muted">Waiting for quote…</div>
      } @else {
        <div class="grid">
          <div>
            <div class="label">BID</div>
            <div class="value" [class]="bidClass()">
              {{ quote()!.bid }}
            </div>
          </div>

          <div>
            <div class="label">ASK</div>
            <div class="value">{{ quote()!.ask }}</div>
          </div>

          <div>
            <div class="label">Last update</div>
            <div class="value small">{{ lastUpdateText() }}</div>
          </div>
        </div>
      }
    </section>

    <section class="card">
      <div class="chart-header">
        <div class="range">
          <button class="btn" [disabled]="loadingCandles()" [class.active]="range() === '15m'" (click)="setRange('15m')">15m</button>
          <button class="btn" [disabled]="loadingCandles()" [class.active]="range() === '1h'" (click)="setRange('1h')">1h</button>
          <button class="btn" [disabled]="loadingCandles()" [class.active]="range() === '6h'" (click)="setRange('6h')">6h</button>
          <button class="btn" [disabled]="loadingCandles()" [class.active]="range() === '24h'" (click)="setRange('24h')">24h</button>
        </div>
      </div>

      <div class="chart-shell">
        <app-candlestick-chart />
      
        @if (loadingCandles()) {
          <div class="overlay">
            <div class="spinner" aria-hidden="true"></div>
            <div>Loading candles…</div>
          </div>
        }
      </div>
    </section>
  </div>
</div>
